GPU available: False, used: False
TPU available: False, using: 0 TPU cores

  | Name             | Type                | Params
---------------------------------------------------------
0 | anchor_generator | AnchorGenerator     | 0     
1 | backbone         | BackboneWithFPN     | 14.3 M
2 | cosloss          | CosineEmbeddingLoss | 0     
3 | model            | RetinaNet           | 23.2 M
4 | bbone            | ResNet              | 11.7 M
5 | extractor        | Sequential          | 11.2 M
6 | teacher_model    | RecognitionModel    | 11.3 M
7 | tm               | Sequential          | 11.2 M
---------------------------------------------------------
46.2 M    Trainable params
0         Non-trainable params
46.2 M    Total params
184.650   Total estimated model params size (MB)
/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:68: UserWarning: The dataloader, val dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
Validation sanity check: 0it [00:00, ?it/s]Validation sanity check:   0%|          | 0/2 [00:00<?, ?it/s]Validation sanity check:  50%|█████     | 1/2 [00:10<00:10, 10.00s/it]Validation sanity check: 100%|██████████| 2/2 [00:21<00:00, 10.47s/it]                                                                      /Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/utilities/distributed.py:68: UserWarning: The dataloader, train dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 4 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  warnings.warn(*args, **kwargs)
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/534 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/534 [00:00<?, ?it/s] > /Users/emilecarron/projects/thesis/detectie/retinanet.py(145)training_step()
-> x, y = batch
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(146)training_step()
-> y = [{'boxes': b, 'labels': l, 'embedding': e}
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(147)training_step()
-> for b, l, e in zip(y['boxes'],y['labels'], y['embedding'])
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(150)training_step()
-> boxes = y[0]['boxes'].int()
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(151)training_step()
-> counter = 0
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(152)training_step()
-> for idx in boxes:
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(153)training_step()
-> height = idx[3]-idx[1]
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(154)training_step()
-> width = idx[2]-idx[0]
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(155)training_step()
-> if height < 7:
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(158)training_step()
-> if width < 7:
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(162)training_step()
-> image = torchvision.transforms.functional.crop(x, idx[1], idx[0], height, width)
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(163)training_step()
-> self.tm.eval()
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(164)training_step()
-> predictions = self.tm(image)
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(165)training_step()
-> embedding_path = self.data_dir + '/SKU110K/annotations/embeddings/embedding' + str(batch_idx) + '_' + str(counter)+'.pt'
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(166)training_step()
-> torch.save(predictions, embedding_path)
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(167)training_step()
-> tensor = torch.load(embedding_path)
(Pdb) > /Users/emilecarron/projects/thesis/detectie/retinanet.py(168)training_step()
-> _, predicted = torch.max(predictions.data, 1)
(Pdb) tensor([[[[0.0000e+00]],

         [[0.0000e+00]],

         [[5.4978e-01]],

         [[8.0048e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2983e-01]],

         [[4.6880e-01]],

         [[2.5697e-02]],

         [[9.3938e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.4897e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.7902e-01]],

         [[5.2440e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.0825e-03]],

         [[0.0000e+00]],

         [[5.7700e-02]],

         [[0.0000e+00]],

         [[5.0133e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.7721e-01]],

         [[1.2580e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.8447e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.0901e+00]],

         [[2.0688e-02]],

         [[3.3037e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.3322e-01]],

         [[9.6901e-02]],

         [[1.1055e+00]],

         [[3.4803e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.2756e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[8.4920e-04]],

         [[1.4195e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0756e-02]],

         [[5.6949e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.9529e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.4581e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.2727e-03]],

         [[8.9330e-05]],

         [[1.7585e-01]],

         [[2.8950e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.9274e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0860e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.3859e-01]],

         [[1.3334e-01]],

         [[0.0000e+00]],

         [[1.0130e-01]],

         [[0.0000e+00]],

         [[9.3168e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.0580e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.7743e-01]],

         [[2.5727e-01]],

         [[0.0000e+00]],

         [[2.9904e-01]],

         [[0.0000e+00]],

         [[5.9538e-01]],

         [[7.7750e-01]],

         [[9.6250e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.3695e-01]],

         [[4.8336e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[4.9744e-01]],

         [[2.0170e-02]],

         [[0.0000e+00]],

         [[1.0217e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.4109e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.4951e-01]],

         [[0.0000e+00]],

         [[9.0888e-01]],

         [[2.3713e-01]],

         [[1.7279e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.7969e-01]],

         [[4.6304e-02]],

         [[1.0448e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.7243e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0230e-01]],

         [[0.0000e+00]],

         [[6.6784e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.6017e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.7613e-01]],

         [[0.0000e+00]],

         [[3.4747e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.1174e+00]],

         [[8.5265e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.6041e-02]],

         [[4.9809e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.9931e-01]],

         [[0.0000e+00]],

         [[5.5213e-02]],

         [[0.0000e+00]],

         [[3.7533e-02]],

         [[0.0000e+00]],

         [[8.4429e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.3390e-01]],

         [[0.0000e+00]],

         [[9.9614e-01]],

         [[2.8205e-01]],

         [[0.0000e+00]],

         [[1.9168e-01]],

         [[0.0000e+00]],

         [[1.5511e-02]],

         [[1.6610e+00]],

         [[9.3205e-03]],

         [[2.2378e-02]],

         [[3.5358e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.1927e-02]],

         [[3.1360e-01]],

         [[0.0000e+00]],

         [[7.5522e-02]],

         [[0.0000e+00]],

         [[6.9279e-02]],

         [[0.0000e+00]],

         [[7.7103e-02]],

         [[4.2285e-02]],

         [[3.2195e-01]],

         [[2.7408e-02]],

         [[1.0916e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2340e-01]],

         [[0.0000e+00]],

         [[5.3276e-02]],

         [[4.9998e-01]],

         [[6.4485e-01]],

         [[0.0000e+00]],

         [[1.8474e-01]],

         [[0.0000e+00]],

         [[8.6601e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.2637e-01]],

         [[8.9770e-01]],

         [[5.3171e-01]],

         [[4.3143e-01]],

         [[5.2642e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.7891e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.5187e-02]],

         [[0.0000e+00]],

         [[1.4706e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.2475e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.6901e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2213e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.2112e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[9.9819e-02]],

         [[0.0000e+00]],

         [[4.7428e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.3079e-02]],

         [[3.0716e+00]],

         [[0.0000e+00]],

         [[1.4436e+00]],

         [[3.4000e-01]],

         [[0.0000e+00]],

         [[2.7061e-02]],

         [[0.0000e+00]],

         [[2.1983e-01]],

         [[1.7340e-01]],

         [[1.6723e+00]],

         [[1.5281e+00]],

         [[0.0000e+00]],

         [[1.5885e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.3608e-03]],

         [[4.7801e-01]],

         [[0.0000e+00]],

         [[1.2284e-01]],

         [[0.0000e+00]],

         [[5.1577e-02]],

         [[9.5775e-02]],

         [[0.0000e+00]],

         [[2.5572e-01]],

         [[0.0000e+00]],

         [[3.8152e-02]],

         [[0.0000e+00]],

         [[2.6057e-02]],

         [[0.0000e+00]],

         [[1.0937e+00]],

         [[2.5369e-01]],

         [[1.0696e+00]],

         [[3.8205e-01]],

         [[3.0715e-02]],

         [[0.0000e+00]],

         [[9.2415e-01]],

         [[3.2936e-01]],

         [[0.0000e+00]],

         [[1.1784e+00]],

         [[1.6064e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.4397e-02]],

         [[1.8522e+00]],

         [[3.9846e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.3418e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[9.7082e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.6994e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.8508e-02]],

         [[0.0000e+00]],

         [[6.6497e-01]],

         [[0.0000e+00]],

         [[1.8392e-01]],

         [[2.2960e-01]],

         [[0.0000e+00]],

         [[7.1163e-02]],

         [[7.6496e-01]],

         [[4.0149e-02]],

         [[4.4033e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.6319e-01]],

         [[1.1823e-01]],

         [[0.0000e+00]],

         [[1.5282e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.4634e-01]],

         [[0.0000e+00]],

         [[4.4987e-01]],

         [[4.5417e-01]],

         [[1.5925e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.2292e+00]],

         [[2.6979e-02]],

         [[3.7387e-04]],

         [[0.0000e+00]],

         [[2.2023e-01]],

         [[0.0000e+00]],

         [[2.6240e-02]],

         [[1.0392e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.8466e-01]],

         [[0.0000e+00]],

         [[2.7221e-01]],

         [[1.3831e+00]],

         [[0.0000e+00]],

         [[7.4073e-04]],

         [[4.5331e-01]],

         [[1.7618e-01]],

         [[4.7673e-01]],

         [[0.0000e+00]],

         [[1.5044e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2341e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[8.0747e-02]],

         [[0.0000e+00]],

         [[6.1063e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.8021e-01]],

         [[1.0630e-01]],

         [[5.4729e-01]],

         [[0.0000e+00]],

         [[2.6421e-01]],

         [[0.0000e+00]],

         [[4.6834e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0073e-01]],

         [[4.0375e-02]],

         [[6.4618e-02]],

         [[4.8600e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.8889e-01]],

         [[2.9407e-02]],

         [[6.6994e-01]],

         [[0.0000e+00]],

         [[1.5668e-01]],

         [[4.5655e-01]],

         [[0.0000e+00]],

         [[8.6703e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.7831e-01]],

         [[8.3525e-02]],

         [[0.0000e+00]],

         [[6.6422e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.2551e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[4.7594e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.9131e-02]],

         [[5.9682e-03]],

         [[0.0000e+00]],

         [[1.7339e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.9086e-01]],

         [[0.0000e+00]],

         [[1.7266e-01]],

         [[2.0923e+00]],

         [[1.2676e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.7505e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.9568e-02]],

         [[0.0000e+00]],

         [[5.0287e-02]]]], requires_grad=True)
(Pdb) tensor([[[[0.0000e+00]],

         [[0.0000e+00]],

         [[5.4978e-01]],

         [[8.0048e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2983e-01]],

         [[4.6880e-01]],

         [[2.5697e-02]],

         [[9.3938e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.4897e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.7902e-01]],

         [[5.2440e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.0825e-03]],

         [[0.0000e+00]],

         [[5.7700e-02]],

         [[0.0000e+00]],

         [[5.0133e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.7721e-01]],

         [[1.2580e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.8447e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.0901e+00]],

         [[2.0688e-02]],

         [[3.3037e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.3322e-01]],

         [[9.6901e-02]],

         [[1.1055e+00]],

         [[3.4803e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.2756e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[8.4920e-04]],

         [[1.4195e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0756e-02]],

         [[5.6949e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.9529e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.4581e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.2727e-03]],

         [[8.9330e-05]],

         [[1.7585e-01]],

         [[2.8950e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.9274e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0860e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.3859e-01]],

         [[1.3334e-01]],

         [[0.0000e+00]],

         [[1.0130e-01]],

         [[0.0000e+00]],

         [[9.3168e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.0580e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.7743e-01]],

         [[2.5727e-01]],

         [[0.0000e+00]],

         [[2.9904e-01]],

         [[0.0000e+00]],

         [[5.9538e-01]],

         [[7.7750e-01]],

         [[9.6250e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.3695e-01]],

         [[4.8336e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[4.9744e-01]],

         [[2.0170e-02]],

         [[0.0000e+00]],

         [[1.0217e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.4109e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.4951e-01]],

         [[0.0000e+00]],

         [[9.0888e-01]],

         [[2.3713e-01]],

         [[1.7279e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.7969e-01]],

         [[4.6304e-02]],

         [[1.0448e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.7243e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0230e-01]],

         [[0.0000e+00]],

         [[6.6784e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.6017e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.7613e-01]],

         [[0.0000e+00]],

         [[3.4747e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.1174e+00]],

         [[8.5265e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.6041e-02]],

         [[4.9809e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.9931e-01]],

         [[0.0000e+00]],

         [[5.5213e-02]],

         [[0.0000e+00]],

         [[3.7533e-02]],

         [[0.0000e+00]],

         [[8.4429e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.3390e-01]],

         [[0.0000e+00]],

         [[9.9614e-01]],

         [[2.8205e-01]],

         [[0.0000e+00]],

         [[1.9168e-01]],

         [[0.0000e+00]],

         [[1.5511e-02]],

         [[1.6610e+00]],

         [[9.3205e-03]],

         [[2.2378e-02]],

         [[3.5358e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.1927e-02]],

         [[3.1360e-01]],

         [[0.0000e+00]],

         [[7.5522e-02]],

         [[0.0000e+00]],

         [[6.9279e-02]],

         [[0.0000e+00]],

         [[7.7103e-02]],

         [[4.2285e-02]],

         [[3.2195e-01]],

         [[2.7408e-02]],

         [[1.0916e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2340e-01]],

         [[0.0000e+00]],

         [[5.3276e-02]],

         [[4.9998e-01]],

         [[6.4485e-01]],

         [[0.0000e+00]],

         [[1.8474e-01]],

         [[0.0000e+00]],

         [[8.6601e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.2637e-01]],

         [[8.9770e-01]],

         [[5.3171e-01]],

         [[4.3143e-01]],

         [[5.2642e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.7891e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.5187e-02]],

         [[0.0000e+00]],

         [[1.4706e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.2475e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.6901e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2213e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.2112e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[9.9819e-02]],

         [[0.0000e+00]],

         [[4.7428e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.3079e-02]],

         [[3.0716e+00]],

         [[0.0000e+00]],

         [[1.4436e+00]],

         [[3.4000e-01]],

         [[0.0000e+00]],

         [[2.7061e-02]],

         [[0.0000e+00]],

         [[2.1983e-01]],

         [[1.7340e-01]],

         [[1.6723e+00]],

         [[1.5281e+00]],

         [[0.0000e+00]],

         [[1.5885e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.3608e-03]],

         [[4.7801e-01]],

         [[0.0000e+00]],

         [[1.2284e-01]],

         [[0.0000e+00]],

         [[5.1577e-02]],

         [[9.5775e-02]],

         [[0.0000e+00]],

         [[2.5572e-01]],

         [[0.0000e+00]],

         [[3.8152e-02]],

         [[0.0000e+00]],

         [[2.6057e-02]],

         [[0.0000e+00]],

         [[1.0937e+00]],

         [[2.5369e-01]],

         [[1.0696e+00]],

         [[3.8205e-01]],

         [[3.0715e-02]],

         [[0.0000e+00]],

         [[9.2415e-01]],

         [[3.2936e-01]],

         [[0.0000e+00]],

         [[1.1784e+00]],

         [[1.6064e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.4397e-02]],

         [[1.8522e+00]],

         [[3.9846e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.3418e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[9.7082e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.6994e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.8508e-02]],

         [[0.0000e+00]],

         [[6.6497e-01]],

         [[0.0000e+00]],

         [[1.8392e-01]],

         [[2.2960e-01]],

         [[0.0000e+00]],

         [[7.1163e-02]],

         [[7.6496e-01]],

         [[4.0149e-02]],

         [[4.4033e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.6319e-01]],

         [[1.1823e-01]],

         [[0.0000e+00]],

         [[1.5282e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.4634e-01]],

         [[0.0000e+00]],

         [[4.4987e-01]],

         [[4.5417e-01]],

         [[1.5925e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.2292e+00]],

         [[2.6979e-02]],

         [[3.7387e-04]],

         [[0.0000e+00]],

         [[2.2023e-01]],

         [[0.0000e+00]],

         [[2.6240e-02]],

         [[1.0392e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.8466e-01]],

         [[0.0000e+00]],

         [[2.7221e-01]],

         [[1.3831e+00]],

         [[0.0000e+00]],

         [[7.4073e-04]],

         [[4.5331e-01]],

         [[1.7618e-01]],

         [[4.7673e-01]],

         [[0.0000e+00]],

         [[1.5044e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.2341e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[8.0747e-02]],

         [[0.0000e+00]],

         [[6.1063e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[3.8021e-01]],

         [[1.0630e-01]],

         [[5.4729e-01]],

         [[0.0000e+00]],

         [[2.6421e-01]],

         [[0.0000e+00]],

         [[4.6834e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.0073e-01]],

         [[4.0375e-02]],

         [[6.4618e-02]],

         [[4.8600e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[7.8889e-01]],

         [[2.9407e-02]],

         [[6.6994e-01]],

         [[0.0000e+00]],

         [[1.5668e-01]],

         [[4.5655e-01]],

         [[0.0000e+00]],

         [[8.6703e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[2.7831e-01]],

         [[8.3525e-02]],

         [[0.0000e+00]],

         [[6.6422e-03]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.2551e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[4.7594e-02]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.9131e-02]],

         [[5.9682e-03]],

         [[0.0000e+00]],

         [[1.7339e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[1.9086e-01]],

         [[0.0000e+00]],

         [[1.7266e-01]],

         [[2.0923e+00]],

         [[1.2676e+00]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[5.7505e-01]],

         [[0.0000e+00]],

         [[0.0000e+00]],

         [[6.9568e-02]],

         [[0.0000e+00]],

         [[5.0287e-02]]]], grad_fn=<MeanBackward1>)
(Pdb) tensor([[[[0.4431, 0.4471, 0.4157,  ..., 0.0863, 0.1020, 0.0980],
          [0.3412, 0.4314, 0.4667,  ..., 0.0941, 0.0980, 0.0980],
          [0.1216, 0.1608, 0.3333,  ..., 0.0863, 0.0863, 0.0902],
          ...,
          [0.9255, 0.9294, 0.9333,  ..., 0.6745, 0.6627, 0.6588],
          [0.9490, 0.9608, 0.9490,  ..., 0.3647, 0.5020, 0.6235],
          [0.9725, 0.8784, 0.9529,  ..., 0.9961, 0.9216, 0.7176]],

         [[0.4902, 0.5020, 0.4784,  ..., 0.1137, 0.1333, 0.1333],
          [0.3725, 0.4706, 0.5137,  ..., 0.1216, 0.1255, 0.1255],
          [0.1373, 0.1843, 0.3608,  ..., 0.1137, 0.1137, 0.1176],
          ...,
          [0.9176, 0.9216, 0.9216,  ..., 0.5647, 0.5412, 0.5294],
          [0.9490, 0.9608, 0.9529,  ..., 0.3176, 0.4510, 0.5529],
          [0.9608, 0.8706, 0.9451,  ..., 0.9843, 0.8941, 0.6745]],

         [[0.5882, 0.5725, 0.5294,  ..., 0.1686, 0.1882, 0.1765],
          [0.5216, 0.5922, 0.6118,  ..., 0.1804, 0.1843, 0.1843],
          [0.3255, 0.3529, 0.5137,  ..., 0.1725, 0.1725, 0.1765],
          ...,
          [0.9647, 0.9686, 0.9686,  ..., 0.5020, 0.4745, 0.4549],
          [0.9882, 0.9961, 0.9961,  ..., 0.2863, 0.4118, 0.5098],
          [0.9804, 0.9059, 0.9843,  ..., 0.9882, 0.8824, 0.6588]]]])
(Pdb) Epoch 0:   0%|          | 0/534 [02:05<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 78, in <module>
    main(args)
  File "train.py", line 59, in main
    trainer.fit(model, dm)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 499, in fit
    self.dispatch()
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 546, in dispatch
    self.accelerator.start_training(self)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/accelerators/accelerator.py", line 73, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 114, in start_training
    self._results = trainer.run_train()
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/trainer.py", line 637, in run_train
    self.train_loop.run_training_epoch()
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/training_loop.py", line 492, in run_training_epoch
    batch_output = self.run_training_batch(batch, batch_idx, dataloader_idx)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/training_loop.py", line 654, in run_training_batch
    self.optimizer_step(optimizer, opt_idx, batch_idx, train_step_and_backward_closure)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/training_loop.py", line 433, in optimizer_step
    using_lbfgs=is_lbfgs,
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/core/lightning.py", line 1390, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/core/optimizer.py", line 214, in step
    self.__optimizer_step(*args, closure=closure, profiler_name=profiler_name, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/core/optimizer.py", line 134, in __optimizer_step
    trainer.accelerator.optimizer_step(optimizer, self._optimizer_idx, lambda_closure=closure, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/accelerators/accelerator.py", line 277, in optimizer_step
    self.run_optimizer_step(optimizer, opt_idx, lambda_closure, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/accelerators/accelerator.py", line 282, in run_optimizer_step
    self.training_type_plugin.optimizer_step(optimizer, lambda_closure=lambda_closure, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 163, in optimizer_step
    optimizer.step(closure=lambda_closure, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/torch/optim/optimizer.py", line 89, in wrapper
    return func(*args, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/torch/optim/adam.py", line 66, in step
    loss = closure()
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/training_loop.py", line 649, in train_step_and_backward_closure
    split_batch, batch_idx, opt_idx, optimizer, self.trainer.hiddens
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/training_loop.py", line 742, in training_step_and_backward
    result = self.training_step(split_batch, batch_idx, opt_idx, hiddens)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/trainer/training_loop.py", line 293, in training_step
    training_step_output = self.trainer.accelerator.training_step(args)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/accelerators/accelerator.py", line 156, in training_step
    return self.training_type_plugin.training_step(*args)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 125, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
  File "/Users/emilecarron/projects/thesis/detectie/retinanet.py", line 168, in training_step
    _, predicted = torch.max(predictions.data, 1)
  File "/Users/emilecarron/projects/thesis/detectie/retinanet.py", line 168, in training_step
    _, predicted = torch.max(predictions.data, 1)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/bdb.py", line 51, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/emilecarron/opt/anaconda3/envs/thesis/lib/python3.6/bdb.py", line 70, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
