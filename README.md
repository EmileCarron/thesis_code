Deze repo bevat de code van onze masterproef.

# Masterproef Nick & Emile

De meeste detectienetwerken gebruiken afzonderlijke netwerken voor de detectie en de labeling of identificatie van de gevonden voorwerpen. Door het gebruik van twee afzonderlijke netwerken kan de real-life implementatie van een dergelijke detector een beetje ingewikkeld zijn. Om dit probleem op te lossen, stellen wij een gezamenlijk detectie- en herkenningsnetwerk voor in plaats van het afzonderlijke detectie- en herkenningsnetwerk. We zullen dit netwerk gebruiken voor productherkenning. De afbeeldingen waarin we de producten zullen detecteren zijn dicht opeengepakt, daarom hebben we een netwerk nodig dat met dit soort afbeeldingen overweg kan.  De afbeeldingen die we gebruiken zijn winkelschappen van de SKU-110k dataset. Het grootste probleem dat we hebben bij het bouwen van ons gezamenlijk netwerk is het feit dat we geen dataset kunnen vinden die zowel kaders heeft voor het detecteren van de producten, als labels om de producten te identificeren. We lossen dit op door een afzonderlijk identificatienetwerk te trainen met de AliProducts en RP2k dataset, zodat we dit netwerk kunnen gebruiken om de bijgesneden beelden te labelen die we vinden met het detectornetwerk. Deze aanpak is gebaseerd op het Student-Teacher model. Het netwerk dat we hiervoor gebruiken is een ResNet18 de kleinste variant van ResNet, zodat het niet te lang duurt om te trainen. De basis van ons gezamenlijk netwerk is het RetinaNet netwerk met een ResNet18 backbone die we aanpassen zodat het een label en embedding kan geven voor alle kaders die het detecteert. Om onze aanpak te valideren, gebruiken we de testgegevens van een winkel van een tankstation om de werking van ons netwerk op ongeziene gegevens te testen. Om het verschil te zien tussen ons gezamenlijk netwerk en de twee afzonderlijke netwerken testen we ze met dezelfde afbeeldingen. De detecties op deze afbeeldingen laten bijna identieke resultaten zien. We zien dat de resultaten van het ResNet18 netwerk getraind op de sample-AliProducts dataset niet zijn zoals we verwacht hadden. Het netwerk labelt zeer gelijkaardige afbeeldingen met een verschillend label en andere totaal verschillende afbeeldingen met hetzelfde label. Het probleem hier is het feit dat de afbeeldingen uit de AliProducts dataset niet lijken op de uitgesneden afbeeldingen van de individuele producten die we gebruiken voor onze validatie. Onze oplossing voor dit probleem is het netwerk opnieuw te trainen met de RP2k dataset die bestaat uit uitgesneden afbeeldingen van producten uit rekken net zoals we gebruiken in onze validatie. De labels die we krijgen van ons gezamenlijk netwerk zijn nu gelijk aan de labels die het aparte herkenningsnetwerk, getraind op de RP2k dataset, ons geeft voor de uitgesneden beelden van het aparte detectienetwerk.  Nu we zien dat de labels vrij goed overeenkomen, kunnen we de afstand tussen de embeddingen van twee totaal verschillende producten vergelijken met de afstanden tussen de embeddingen van twee op elkaar gelijkende producten. Uit deze experimenten blijkt dat de afstand tussen gelijksoortige producten kleiner is dan de afstand tussen totaal verschillende producten. Hieruit kunnen we concluderen dat onze aanpak even goed zou kunnen werken als de aanpak met twee afzonderlijke netwerken. Om dit te bereiken moeten we ons netwerk veel langer trainen, zodat we het volledige potentieel ervan kunnen zien. Bovendien hebben we maar één netwerk nodig in plaats van twee en hebben we dus een oplossing die veel gemakkelijker te implementeren is in een real-life omgeving.

